/*
  Descargar Hist√≥rico DCM LATAM
*/

function DownloadDCMReportsLatamID() 
{
      //ProfileID
      var id_pf  = 4092538;      
      //Reports ID's
      var id_reports = ['98067874','98068761','98072139']; //'basic', 'conversions', 'streamVideo'
      //DCM Reports folder ID
      var id_folder = '0B7ugPHSFvzjKRXd6RnBrWm4zOVU';
      //Name Files
      var name_files = ['Basic_Daily_Latam','Conversions_Daily_Latam','StreamV_Daily_Latam'];
      
      //Basic Report Files
      var file_id0=[ '591364504','591364396','591364501','591364442','591364395','591364500','591364098','591364099','591364437','591364436','591364388','591364095','591364433','591364432','591363018',
                    '591364385','591364382','591364383','591364090','591364431','591364088','591364427','591364428','591364425','591364379','591364424','591364422','591364085','591364376','591364374',
                    '591362256','591362257','591360967','591360966','591363009','591362252','591364417','591364372','591363007','591364079','591364371','591364369','591364368','591364078','591364077',
                    '591364074','591364076','591364415','591364073','591364411','591360956','591364363','591364364','591362999','591364362','591364070','591364409','591364407','591364066','591364405',
                    '591364404','591364403','591364402','591364063','591364062','591364401','591364400','591360953','591364354','591364060','591364059','591364298','591364297','591364296','591364350',
                    '591364295','591364294','591364348','591364055','591364346','591364052','591364345','591364291','591364344','591364290','591364288','591364048','591364286','591364339','591364285',
                    '591364337','591364046','591364036','591364328','591364275','591364274','591364273','591364326','591364271','591364322','591364030','591364320','591364321','591364266','591364319',
                    '591364263','591364317','591364262','591364260','591364021','591364312','591364019',
                    '591364258','591364310','591364017','591364018','591364016','591364015','591364306','591364013','591364253','591364249','591364300','591364305','591364252','591364007','591364244',
                    '591364005','591364004','591364240','591364242','591364195','591364234','591363996','591363993','591364232','591364184','591363990','591364183','591364181','591364228','591364226',
                    '591363988','591364225','591364179','591363985','591363984','591364221','591364173','591364172','591364170','591363976','591364169','591364213','591364167','591363974','591364165',
                    '591363972','591363973','591363971','591364208','591364162','591364161','591364160','591363968','591364159','591364205','591364202','591363961','591364155','591363960','591363898',
                    '591363959','591364149','591364147','591364148','591364146','591363954','591363952','591363889','591364143','591363951','591363949','591363887','591363947','591364139','591363946',
                    '591363883','591363944','591363942','591364132','591364133','591364131','591363939','591363937','591363876','591363933','591364123','591364124','591363869','591363868','591364119',
                    '591364121','591362016','591363929','591363927','591362872','591364117','591363863','591364116','591363861','591363860'];
    
      //Conversions Report Files                  
      var file_id0=[ '591366268','591366087','591368112','591366273','591366272','591366271','591366269','591368108','591366263','591368106','591366455','591366259','591366451','591366096','591366448',
                    '591366449','591366094','591366254','591366092','591366093','591366444','591366252','591366090','591366442','591366249','591366439','591366247','591366086','591366085','591366084',
                    '591366437','591366082','591366083','591366080','591366240','591366433','591366077','591366689','591366079','591366236','591366237','591366235','591366424','591366230','591366422',
                    '591366228','591366653','591366227','591366421','591366418','591366065','591366226','591366225','591366223','591366629','591366615','591366060','591366415','591366413','591366220',
                    '591366057','591366410','591366411','591366409','591366218','591366055','591366563','591366406','591366051','591367328','591366370','591366367','591366403','591366048','591366047',
                    '591366402','591366209','591365786','591365778','591366400','591365998','591366207','591366045','591366206','591365993','591366044','591365996','591366042','591366202','591366038',
                    '591365898','591365990','591365859','591365951','591365949','591365857','591365194','591365855','591365854','591365192','591365853','591365190','591365941','591365942','591365186',
                    '591365846','591365184','591365937','591365936','591365183','591365843','591365841',
                    '591365931','591365836','591365927','591365834','591365172','591365924','591365925','591365170','591365831','591365829','591365922','591365164','591365167','591365919','591365917',
                    '591365822','591365161','591365913','591365912','591365159','591365158','591365157','591365909','591365156','591365900','591365805','591365143','591365804','591364995','591365803',
                    '591365140','591365802','591365139','591364993','591364994','591365801','591364898','591365132','591364984','591365130','591365129','591364982','591364981','591364979','591365125',
                    '591364886','591364975','591364974','591364881','591364970','591364878','591364877','591365115','591364969','591364968','591364875','591364967','591364966','591365112','591365111',
                    '591364873','591364964','591365108','591364960','591365106','591364956','591364957','591364865','591364863','591364955','591363175','591364862','591364799','591362395','591364951',
                    '591364859','591364796','591364945','591363086','591364852','591364791','591364790','591364788','591364941','591362327','591364786','591364784','591364937','591364777','591364930',
                    '591364772','591364833','591364832','591364770','591364922','591364924','591364828','591364768','591364769','591364920'];
                 
      //Stream Report Files
      var file_id=[ '591371907','591369468','591371918','591369473','591371903','591371908','591371910','591371912','591371914','591371915','591369443','591369446','591369448','591369449','591369450',
                    '591372108','591372109','591372111','591372118','591372123','591372124','591372125','591369454','591369457','591369458','591369459','591369464','591369466','591369467','591369470',
                    '591371922','591371924','591371925','591371926','591371931','591371938','591371941','591369471','591369475','591369479','591372128','591369413','591371902','591371905','591371920',
                    '591369441','591369198','591372110','591372120','591369455','591369463','591371932','591371933','591372131','591369452','591369440','591371901','591369439','591369162','591369411',
                    '591369412','591369416','591369073','591371900','591369409','591369193','591369418','591369182','591369091','591369063','591369074','591369076','591369172','591369174','591369175',
                    '591369425','591369430','591369431','591369433','591369083','591369084','591369087','591369186','591369192','591369435','591369436','591369437','591369417','591369181','591369188',
                    '591369165','591369167','591369414','591369070','591369170','591369173','591369178','591369419','591369427','591369079','591369081','591369082','591369187','591369434','591369176',
                    '591369179','591369180','591369086','591369088','591369124','591369125','591369408',
                    
                    '591369069','591369067','591369159','591369066','591369065','591369064','591369403','591369156','591369062','591369401','591369150','591368894','591369052','591369050','591369143',
                    '591368889','591369049','591368887','591369141','591368886','591369047','591369140','591368884','591369137','591369046','591369044','591369043','591369136','591369132','591369038',
                    '591369040','591369037','591369129','591368874','591369034','591369127','591369033','591369123','591369122','591368868','591369120','591369028','591368867','591368866','591369026',
                    '591369119','591369025','591369117','591369023','591369115','591368858','591369109','591369108','591368853','591369105','591369013','591368850','591369103','591368846','591369010',
                    '591369009','591368799','591368798','591368797','591369004','591368842','591368841','591368840','591369002','591368794','591368839','591368793','591368792','591368397','591368785',
                    '591368829','591368828','591368827','591368780','591368779','591368388','591368824','591368385','591368386','591368777','591368822','591368776','591368775','591368823','591368381',
                    '591368380','591368771','591368372','591368813','591368374','591368809','591368762','591368369','591368808','591368368'];
 
      var dFolder = DriveApp.getFolderById(id_folder);
      Logger.log(dFolder);
     

     for (var i = 0; i < file_id.length; i++)
     {
      var reportFile = DoubleClickCampaigns.Reports.Files.get(id_pf, id_reports[2], file_id[i]); 
      Logger.log(reportFile.id)
      Logger.log(reportFile.dateRange.startDate)
      if(reportFile.urls) 
      {
        var httpOptions = {
          'method' : 'get',
          'headers': {'Authorization': 'Bearer ' + ScriptApp.getOAuthToken()}             
        }
        //Limited by 10MB
        var contents = UrlFetchApp.fetch(reportFile.urls.apiUrl, httpOptions);                          
        
        //Create CSV en DCM Reports/
        dFolder.createFile(name_files[2] + '-' + reportFile.dateRange.startDate, contents, MimeType.CSV);
      }
    }                      
}
